# Investor Uploader â€“ Engineering Challenge Submission

## Purpose

A Phoenix LiveView application enabling partner platforms to ingest investor KYC data and supporting documents. The solution was completed in roughly **2.5â€¯hours** (plus README polish) for the iCapital Identity team coding exercise.

---

## LiveView Pages

| # | Path             | Description                                                                                                                                                                                                                |
| - | ---------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1 | `/investors/new` | **Add Investor** â€“ Live form with realâ€‘time validation. Required fields: first/last name, email (unique), DOB, phone (10â€¯digits), street address, state (dropdown), ZIP (5â€¯digits).  |
| 2 | `/investors`     | **Investor List** â€“ Paginated list of all investors with an **â€œAdd Investorâ€** button and **â€œViewâ€** link for each row.                                                                                                    |
| 3 | `/investors/:id` | **Investor Detail** â€“ Shows all captured fields, existing documents, and a LiveView uploader to attach additional docs (same size/type rules).                                                                             |

---

## Validation Rules

* **Presence** â€“ every form field is required.
* **Length / Format**

  * `first_name`, `last_name` â€“ 1â€‘50 chars
  * `email` â€“ RFCâ€‘5322 regex
  * `phone` â€“ exactly 10 digits
  * `zip_code` â€“ 5 digits
* **State** â€“ inclusion from 50â€‘state dropdown.
* **Email Uniqueness** â€“ enforced at DB + changeset level.
* **Document Upload**

  * Types: `.pdf .png .jpg .jpeg`
  * Size: â‰¤â€¯3â€¯MB
  * Progress + cancel link during upload.

---

## Tech Stack

* **ElixirÂ 1.15 / OTPÂ 26**
* **Phoenixâ€¯1.7 / LiveViewâ€¯0.20**
* **PostgreSQLâ€¯15** with UUID PKs
* **Ecto** for validations & constraints
* **Tailwind** for quick styling (generated by phx installer)

---

## Running Locally

```bash
# Clone
git clone https://github.com/pinkeshsoni03/investor-uploader.git
cd investor-uploader

# Install deps & assets
mix deps.get

# DB
mix ecto.setup   # creates DB + runs migrations

# Start server
mix phx.server   # http://localhost:4000
```

### Tests

```bash
mix test  # unit & LiveView integration
```

---

## Feature Summary

* Realâ€‘time validated investor capture (pageâ€¯1).
* Listing with navigation actions (pageâ€¯2).
* Detail view + additional document uploads (pageâ€¯3).
* All investor/document CRUD fenced inside a dedicated **Partners** context.
* Comprehensive ExUnit suite covering validation edgeâ€‘cases, unique constraints, assoc constraints, and LiveView behaviour.
* Logical commits showing incremental development.

---

## Future Enhancements

| Area            | Idea                                          |
| --------------- | --------------------------------------------- |
| Bulk Onboarding | CSV & multiâ€‘file dragâ€‘nâ€‘drop.                 |
| Auth            | phx.gen.auth to separate partner tenants.     |
| Storage         | Stream uploads to S3 + virus scan via Oban.   |
| UX              | Pagination, search, and sorting on list page. |
| Devâ€‘Ops         | DockerÂ Compose & GitHub Actions CI.           |

---


### âœ¨â€¯EnhancementÂ â€”Â Serverâ€‘Side Pagination (v1.1)

The investor listing page (`/investors`) now scales gracefully thanks to **serverâ€‘side pagination** powered by \[`scrivener_ecto`â€¯\~>â€¯2.7].

| UI                          | Behaviour                                                                     |
| --------------------------- | ----------------------------------------------------------------------------- |
| **Â«â€¯Prev / Nextâ€¯Â» buttons** | Navigate to the previous or next page. Disabled when at the beginning or end. |
| **Pageâ€‘number links**       | Jump directly to a specific page (first, current Â±2, last).                   |
| **LiveView patches**        | Pagination is **instant**â€”only the table is reâ€‘rendered, no fullâ€‘page load.   |

#### How it works

1. **Dependency** Â Â `{:scrivener_ecto, "~> 2.7"}` added inâ€¯`mix.exs`.
2. **Repo config** Â Â `use Scrivener, page_size: 5` in `InvestorUploader.Repo`.
3. **Context** Â Â `Partners.list_investors/1` now returns a `%Scrivener.Page{}` given a params map (`%{"page" => "2"}` etc.).
4. **LiveView**

   * Reads `page` from the URL params in `handle_params/3`.
   * Assigns `@page` (`%Scrivener.Page{}`) and renders only `@page.entries`.
   * Renders `<.pagination page={@page} />` component that outputs Â«â€¯Prev / Nextâ€¯Â» and numbered links.
5. **Routing** Â Â URLs look like `/investors?page=3`; LiveView keeps patching rather than redirecting.

```elixir
# lib/investor_uploader/partners.ex
def list_investors(params \\ %{}) do
  Investor
  |> order_by([i], desc: i.inserted_at)
  |> Repo.paginate(params)
end
```

#### Configuration

| ENV         | Default | Description                                               |
| ----------- | ------- | --------------------------------------------------------- |
| `PAGE_SIZE` | `5`    | Investors per page (overrides `Repo.paginate/2` default). |

> **Tip:** Change `page_size` on a perâ€‘request basis via query param: `/investors?page_size=25`.

This enhancement keeps the UI snappy even with thousands of investor records and sets the stage for future filters and search.

## Author

**Pinkeshâ€¯Soni**
ðŸ“§Â [pinkeshsoni03@gmail.com](mailto:pinkeshsoni03@gmail.com)â€ƒðŸ“±Â +1Â 201â€‘238â€‘8972
